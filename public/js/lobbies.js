function getPlayers(){$.getJSON("ajax/lobby/"+lobbyId+"/player-count",function(a){"deleted"==a.error?swal({title:"Whoops, the lobby's gone!",text:"Seems the host deleted this lobby",type:"warning"},function(){window.location.replace(base_url+"dashboard")}):a.count!=playerCount&&(playerCount=a.count,$.getJSON("ajax/lobby/"+lobbyId+"/get-players",function(a){$(".players").empty(),$.each(a,function(a,b){var c;c=null!=b.img?b.img:"img/profile.png";var d=hostId==b.id;$player='<div class="row blocklink-wrapper"><div class="col-md-12 blocklink"><a href="users/'+b.slug+'"><div class="col-md-3"><div class="profile-img"><img src="'+c+'" alt="'+b.username+'"></div></div><div class="col-md-9"><h5>'+b.username,d&&($player+=" (host)"),$player+="</h5></div></a></div></div>",$(".players").append($player)})}),$(".progress-bar").css("width",a.count/size*100+"%"),$(".progress-bar .sr-only").text(a.count/size*100+"% full"),$(".progress-bar .ratio").text(a.count+"/"+size))})}function formatUser(a){if(a.loading)return a.text;var b=null!=a.img?a.img:"img/profile.png",c='<div class="selectbox-result row blocklink-wrapper persist-cols"><div class="col-md-12 blocklink user"><div class="row"><div class="col-md-4"><div class="profile-img"><img src="'+b+'" alt="'+a.text+'"></div></div><div class="col-md-8"><p class="name">'+a.text+"</p></div></div></div></div>";return c}function formatUserSelection(a){return a.text}$(function(){$("#user-find").length>0&&$("#user-find").select2({placeholder:"Find and invite friends/team-mates",ajax:{url:"ajax/me/find-acquaintances",dataType:"json",delay:250,minimumInputLength:2,data:function(a){return{q:a.term,page:a.page}},processResults:function(a,b){return b.page=b.page||1,{results:a,pagination:{more:30*b.page<a.total_count}}},cache:!0},escapeMarkup:function(a){return a},templateResult:formatUser,templateSelection:formatUserSelection}),$('input[name="stealth"]').change(function(){1==$(this).val()?$(".stealth-mode").slideDown():$(".stealth-mode").slideUp()}),$(".lobby-view").length>0&&(getPlayers(),setInterval(function(){getPlayers()},1e4)),$("#invite-players-form").submit(function(a){a.preventDefault(),$.post($(this).attr("action"),$(this).serialize()),$("#invite-players").modal("toggle"),getPlayers()})});